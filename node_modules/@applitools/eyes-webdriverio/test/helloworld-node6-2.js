function main() {

    const webdriverio = require('webdriverio');
    const chromedriver = require('chromedriver');

    // Start chromedriver
    chromedriver.start();

    // Open a Chrome browser.
    const browserOptions = {
        port: '9515',
        path: '/',
        desiredCapabilities: {
            browserName: 'chrome',
            chromeOptions: {
                args: [
                    'disable-infobars',
                ]
            }
        }
    };

    // Initialize the eyes SDK and set your private API key.
    const {Eyes, Target} = require('../index');

    let eyes = new Eyes();
    eyes.setApiKey(process.env.APPLITOOLS_API_KEY);

    const browser = webdriverio.remote(browserOptions);
    return browser.init().then(() => {
        // Start the test and set the browser's viewport size to 800x600.
        return eyes.open(browser, 'Hello World!', 'My first Javascript test!', {width: 800, height: 600})
    }).url('https://applitools.com/helloworld').call(function () {
        // Visual checkpoint #1.
        return eyes.check('Main Page', Target.window());
    }).then(function () {
        // Click the "Click me!" button.
        return browser.click('button');
    }).then(function () {
        // Visual checkpoint #2.
        return eyes.check('Click!', Target.window());
    }).then(function () {
        // End the test.
        return eyes.close();
    }).catch(function (err) {
        console.error(err.message);
        // If the test was aborted before eyes.close was called ends the test as aborted.
        return eyes.abortIfNotClosed();
    }).then(function (res) {
        // Close the browser.
        return browser.end();
    }).then(function () {
        // Stop chromedriver
        chromedriver.stop();
    });
}

main();